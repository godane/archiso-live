# Maintainer: Geoffroy Carrier <geoffroy.carrier@aur.archlinux.org>
# Contributor: Andrea Scarpino <bash.lnx@gmail.com>
# Contributor: Roman Kyrylych <roman@archlinux.org>
# Contributor: Michal Krenek <mikos@sg1.cz>
# Contributor: niQo
# Contributor: Ingmar Steen 
 
pkgname=virtualbox-modules
pkgver=2.1.2
pkgrel=5
pkgdesc="Kernel modules for VirtualBox (vboxdrv)"
arch=('i686')
url="http://www.virtualbox.org"
license=('GPL')
depends=()
#makedepends=('bin86' 'dev86' 'iasl' 'libstdc++5' 'qt3' 'sdl_ttf' 'libxt'
#             'libgl' 'alsa-lib' 'pulseaudio' 'gcc34' 'libxcursor' 'libidl2' 'libxslt'
#             'xalan-c' 'pth' 'libxml2' 'libidl2' 'libpng')
install=$pkgname.install
#source=(http://download.virtualbox.org/virtualbox/$pkgver/VirtualBox-$pkgver-OSE.tar.bz2)
source=($pkgname.tar.gz)
build() {
  source "${startdir}"/../kernel.env
  cd "$srcdir/$pkgname/vboxdrv"

  make KERN_DIR=${_kerndir} || return 1
  install -D -m644 vboxdrv.ko "$pkgdir/lib/modules/${_kernver}/misc/vboxdrv.ko"
  #install -D -m644 vboxnetflt.ko "$pkgdir/lib/modules/${_kernver}/misc/vboxnetflt.ko"
  sed -i -e "s/KERNEL_VERSION='.*'/KERNEL_VERSION='${_kernver}'/" "$startdir/virtualbox-modules.install"
}
md5sums=('f381048fae3aa7924fcfc134f1a59ebf')
